# Pep-Edit_ST

Scripts to run Simulated Tempering simulations using Pep-Edit webserver inputs.

This repository provides a conda environment and tools to perform simulated tempering molecular dynamics simulations starting from:
- PDB files generated by the [PEP-EDIT webserver](https://www.dsimb.inserm.fr/PEPFOLD3/)
- SMILES strings for small molecules/ligands

## Features

- **Conda Environment**: Easy setup with all required dependencies
- **RDKit Integration**: Handle SMILES strings and small molecules
- **OpenMM Simulations**: Run molecular dynamics with OpenMM (>=8.3.1)
- **Simulated Tempering**: Use SST2 module for enhanced sampling

## Requirements

- Conda or Miniconda
- Python >= 3.9
- RDKit (from conda-forge)
- OpenMM >= 8.3.1
- SST2 module

## Installation

### 1. Create the Conda Environment

Clone this repository and create the conda environment:

```bash
git clone https://github.com/samuelmurail/Pep-Edit_ST.git
cd Pep-Edit_ST
conda env create -f environment.yml
```

This will create a new conda environment named `pep-edit-st` with all required dependencies.

### 2. Activate the Environment

```bash
conda activate pep-edit-st
```

### 3. Verify Installation

Check that all modules are properly installed:

```bash
python -c "import rdkit; import openmm; import sst2; print('All modules loaded successfully!')"
```

## Usage

Python scripts for running simulated tempering simulations will be added to this repository. The scripts will support:

- Loading PDB files from the PEP-EDIT webserver
- Processing SMILES strings for small molecules/ligands
- Configuring and running simulated tempering simulations
- Generating output trajectories and analysis files

### Expected Workflow

1. **Prepare Structure**: Get your PDB file from the PEP-EDIT webserver
2. **Activate Environment**: `conda activate pep-edit-st`
3. **Run Simulation**: Use the provided scripts with appropriate parameters
4. **Analyze Results**: Use the output trajectory and log files for analysis

## Dependencies

The environment includes:
- **RDKit**: Chemistry toolkit for handling molecules
- **OpenMM** (>=8.3.1): Molecular dynamics simulation engine
- **SST2**: Simulated tempering implementation
- **NumPy**: Numerical computing
- **Pandas**: Data manipulation
- **Matplotlib**: Plotting and visualization

## Updating the Environment

To update the environment with new dependencies:

```bash
conda env update -f environment.yml --prune
```

To remove and recreate the environment:

```bash
conda env remove -n pep-edit-st
conda env create -f environment.yml
```

## Troubleshooting

### Module Not Found

If you get module import errors, ensure the environment is activated:

```bash
conda activate pep-edit-st
```

### OpenMM Version

To check your OpenMM version:

```bash
python -c "import openmm; print(openmm.__version__)"
```

Ensure it's >= 8.3.1.

### SST2 Installation Issues

If SST2 fails to install, try installing it manually:

```bash
pip install git+https://github.com/samuelmurail/SST2.git
```

## Contributing

Contributions are welcome! Please feel free to submit issues or pull requests.

## License

See LICENSE file for details.

## References

- [PEP-EDIT Webserver](https://www.dsimb.inserm.fr/PEPFOLD3/)
- [SST2 GitHub Repository](https://github.com/samuelmurail/SST2)
- [OpenMM Documentation](http://docs.openmm.org/)
- [RDKit Documentation](https://www.rdkit.org/docs/)
